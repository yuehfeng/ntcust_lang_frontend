{"remainingRequest":"C:\\www-server\\ntcust_lang_frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\www-server\\ntcust_lang_frontend\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\www-server\\ntcust_lang_frontend\\src\\libs\\myUploadAdapter.js","dependencies":[{"path":"C:\\www-server\\ntcust_lang_frontend\\src\\libs\\myUploadAdapter.js","mtime":1654731676829},{"path":"C:\\www-server\\ntcust_lang_frontend\\babel.config.js","mtime":1647072923606},{"path":"C:\\www-server\\ntcust_lang_frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645007183919},{"path":"C:\\www-server\\ntcust_lang_frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1645007186797},{"path":"C:\\www-server\\ntcust_lang_frontend\\node_modules\\eslint-loader\\index.js","mtime":1645007184600}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOlxcd3d3LXNlcnZlclxcbnRjdXN0X2xhbmdfZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGNsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcd3d3LXNlcnZlclxcbnRjdXN0X2xhbmdfZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGNyZWF0ZUNsYXNzLmpzIjsKCi8vIGNsYXNzIOaYr2pz55qE5bu65qeL5Ye95byPCnZhciBNeVVwbG9hZEFkYXB0ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIE15VXBsb2FkQWRhcHRlcihsb2FkZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNeVVwbG9hZEFkYXB0ZXIpOwoKICAgIC8vIFRoZSBmaWxlIGxvYWRlciBpbnN0YW5jZSB0byB1c2UgZHVyaW5nIHRoZSB1cGxvYWQuCiAgICB0aGlzLmxvYWRlciA9IGxvYWRlcjsKICB9IC8vIFN0YXJ0cyB0aGUgdXBsb2FkIHByb2Nlc3MuCgoKICBfY3JlYXRlQ2xhc3MoTXlVcGxvYWRBZGFwdGVyLCBbewogICAga2V5OiAidXBsb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGxvYWQoKSB7CiAgICAgIHZhciB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdC9udGN1c3RfbGFuZ19iYWNrZW5kL3B1YmxpYy9hcGkvZmlsZS9jcmVhdGUiOwogICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlIiwgdGhpcy5sb2FkZXIpOwogICAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICByZXF1ZXN0Lm9wZW4oIlBPU1QiLCB1cmwpOwogICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQVBJX1RPS0VOJykpOwogICAgICByZXF1ZXN0LnNlbmQoZm9ybURhdGEpOwoKICAgICAgcmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHJlcXVlc3QucmVhZHlTdGF0ZSA9PT0gNCkgewogICAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXNUZXh0ID09PSAnT0snKSB7CiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVxdWVzdC5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07IC8vIHRoaXMubG9hZGVyIOWwseaYr+WbnuWCs+eahOaqlOahiO+8jOiAjOaIkeWAkeS4iuWCs+eahOaqlOahiO+8jOWwseaYr2xvYWRlcuS4i+mdoueahGZpbGXvvIzogIxmaWxl5pivcHJvbWlzZeagvOW8jwogICAgICAvLyByZXNvbHZl55qE5Yqf6IO977yM5piv6YCB57WmQ0tFZGl05L2/55SoCiAgICAgIC8vIOWbnuWCs+aYr+WxrOaWvOmdnuWQjOatpeihjOeCuu+8jOaJgOS7peacg+W7uuS4gOWAi+aWsOeahFByb21pc2UKICAgICAgLy8gaGVhZGVyc+eahOebrueahOaYr+WBmumpl+itiQogICAgICAvLyByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgLy8gdGhpcy5sb2FkZXIuZmlsZS50aGVuKChsb2FkRmlsZSkgPT4gewogICAgICAvLyAgICAgY29uc29sZS5sb2cobG9hZEZpbGUpCiAgICAgIC8vICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBsb2FkRmlsZSk7CiAgICAgIC8vICAgICByZXR1cm4gYXhpb3MKICAgICAgLy8gICAgIC5wb3N0KHVybCwgZm9ybURhdGEsIHsKICAgICAgLy8gICAgICAgICBoZWFkZXJzOiB7CiAgICAgIC8vICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScsCiAgICAgIC8vICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0FQSV9UT0tFTicpCiAgICAgIC8vICAgICAgICAgfSwKICAgICAgLy8gICAgIH0pCiAgICAgIC8vICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhLnBhdGgpOwogICAgICAvLyAgICAgICAgIHJlc29sdmUoewogICAgICAvLyAgICAgICAgICAgICBkZWZhdWx0OiByZXNwb25zZS5kYXRhLmltYWdlVXJsLAogICAgICAvLyAgICAgICAgIH0pOwogICAgICAvLyAgICAgfSk7CiAgICAgIC8vIH0pOwogICAgICAvLyB9KTsKCiAgICB9IC8vIEFib3J0cyB0aGUgdXBsb2FkIHByb2Nlc3MuCgogIH0sIHsKICAgIGtleTogImFib3J0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHsKICAgICAgaWYgKHRoaXMueGhyKSB7CiAgICAgICAgdGhpcy54aHIuYWJvcnQoKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIE15VXBsb2FkQWRhcHRlcjsKfSgpOyAvLyDljK/lh7rmqpTmoYgKCgpleHBvcnQgZGVmYXVsdCBNeVVwbG9hZEFkYXB0ZXI7"},{"version":3,"sources":["C:/www-server/ntcust_lang_frontend/src/libs/myUploadAdapter.js"],"names":["MyUploadAdapter","loader","url","formData","FormData","append","request","XMLHttpRequest","open","setRequestHeader","localStorage","getItem","send","onreadystatechange","readyState","status","statusText","console","log","response","data","xhr","abort"],"mappings":";;;AAAA;IACMA,e;AACF,2BAAYC,MAAZ,EAAoB;AAAA;;AAChB;AACA,SAAKA,MAAL,GAAcA,MAAd;AACH,G,CAEH;;;;;WACE,kBAAS;AACL,UAAMC,GAAG,gEAAT;AACA,UAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB,KAAKJ,MAA7B;AACA,UAAIK,OAAO,GAAG,IAAIC,cAAJ,EAAd;AACAD,MAAAA,OAAO,CAACE,IAAR,CAAa,MAAb,EAAqBN,GAArB;AACAI,MAAAA,OAAO,CAACG,gBAAR,CAAyB,eAAzB,EAA0C,YAAYC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAtD;AACAL,MAAAA,OAAO,CAACM,IAAR,CAAaT,QAAb;;AAEAG,MAAAA,OAAO,CAACO,kBAAR,GAA6B,YAAY;AACrC,YAAIP,OAAO,CAACQ,UAAR,KAAuB,CAA3B,EAA8B;AAC1B,cAAIR,OAAO,CAACS,MAAR,KAAmB,GAAnB,IAA0BT,OAAO,CAACU,UAAR,KAAuB,IAArD,EAA2D;AACvD,mBAAOV,OAAP;AACH,WAFD,MAEO;AACHW,YAAAA,OAAO,CAACC,GAAR,CAAYZ,OAAO,CAACa,QAAR,CAAiBC,IAA7B;AACH;AACJ;AACJ,OARD,CATK,CAkBL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACH,K,CAED;;;;WACA,iBAAQ;AACJ,UAAI,KAAKC,GAAT,EAAc;AACV,aAAKA,GAAL,CAASC,KAAT;AACH;AACJ;;;;KAGL;;;AACA,eAAetB,eAAf","sourcesContent":["// class 是js的建構函式\r\nclass MyUploadAdapter {\r\n    constructor(loader) {\r\n        // The file loader instance to use during the upload.\r\n        this.loader = loader;\r\n    }\r\n\r\n  // Starts the upload process.\r\n    upload() {\r\n        const url = `http://localhost/ntcust_lang_backend/public/api/file/create`;\r\n        const formData = new FormData();\r\n        formData.append(\"file\", this.loader);\r\n        var request = new XMLHttpRequest();\r\n        request.open(\"POST\", url);\r\n        request.setRequestHeader('Authorization', 'Bearer ' + localStorage.getItem('API_TOKEN'));\r\n        request.send(formData);\r\n\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4) {\r\n                if (request.status === 200 && request.statusText === 'OK') {\r\n                    return request\r\n                } else {\r\n                    console.log(request.response.data);\r\n                }\r\n            }\r\n        }\r\n        // this.loader 就是回傳的檔案，而我們上傳的檔案，就是loader下面的file，而file是promise格式\r\n        // resolve的功能，是送給CKEdit使用\r\n        // 回傳是屬於非同步行為，所以會建一個新的Promise\r\n        // headers的目的是做驗證\r\n        // return new Promise((resolve) => {\r\n        // this.loader.file.then((loadFile) => {\r\n        //     console.log(loadFile)\r\n        //     formData.append('file', loadFile);\r\n        //     return axios\r\n        //     .post(url, formData, {\r\n        //         headers: {\r\n        //             'Content-Type': 'multipart/form-data',\r\n        //             'Authorization': 'Bearer ' + localStorage.getItem('API_TOKEN')\r\n        //         },\r\n        //     })\r\n        //     .then((response) => {\r\n        //         console.log(response.data.path);\r\n        //         resolve({\r\n        //             default: response.data.imageUrl,\r\n        //         });\r\n        //     });\r\n        // });\r\n        // });\r\n    }\r\n\r\n    // Aborts the upload process.\r\n    abort() {\r\n        if (this.xhr) {\r\n            this.xhr.abort();\r\n        }\r\n    }\r\n}\r\n\r\n// 匯出檔案\r\nexport default MyUploadAdapter;\r\n"]}]}